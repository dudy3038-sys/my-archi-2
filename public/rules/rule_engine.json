{
  "version": "0.4.2",
  "updated_at": "2026-02-05",
  "notes": [
    "checklists.json + rule_engine.json 분리 구조",
    "auto_rules는 '빠른 1차 판정'만 담당(확정 판정보다 안내/리스크 표시 목적)",
    "need_input은 UX상 최소화: 입력이 없어도 기본은 conditional로 안내하고, 정말 불가피한 경우만 need_input 사용"
  ],
  "default_conditional": [
    {
      "id": "road_access",
      "rule_set": {
        "strategy": "first_match",
        "default_result": "conditional",
        "default_message": "⚠️ 도로 접도는 핵심 요건입니다. 도로 폭을 입력하거나 도면/현황으로 확인해 주세요."
      },
      "optional_inputs": [],
      "auto_rules": [
        {
          "id": "road_missing",
          "priority": 110,
          "when": { "op": "missing", "key": "road_width_m" },
          "result": "conditional",
          "message": "도로 폭 입력이 없어요. 4m 이상 접도 여부를 확인해 주세요."
        },
        {
          "id": "deny_narrow_road",
          "priority": 100,
          "when": { "op": "lt", "key": "road_width_m", "value": 4 },
          "result": "deny",
          "message": "도로 폭 4m 미만이면 건축 제한 가능성 큼(접도/지정도로/현황도로 등 추가 확인 필요)"
        },
        {
          "id": "allow_ok_road",
          "priority": 10,
          "when": { "op": "gte", "key": "road_width_m", "value": 4 },
          "result": "allow",
          "message": "도로 폭 4m 이상(기본 기준 충족) — 단, 지정도로/폭원 산정 기준은 별도 확인"
        }
      ]
    },

    {
      "id": "parking",
      "rule_set": {
        "strategy": "first_match",
        "default_result": "conditional",
        "default_message": "⚠️ 주차는 용도·면적·지자체 조례에 따라 크게 달라져요. 조례 기준으로 수동 확인이 필요합니다."
      },
      "optional_inputs": ["gross_area_m2"],
      "auto_rules": [
        {
          "id": "parking_missing",
          "priority": 100,
          "when": { "op": "missing", "key": "gross_area_m2" },
          "result": "conditional",
          "message": "연면적 입력이 없어요. 연면적(또는 계획 규모)을 입력하면 더 구체적으로 안내할 수 있어요."
        }
      ]
    },

    {
      "id": "daylight",
      "rule_set": {
        "strategy": "first_match",
        "default_result": "conditional",
        "default_message": "⚠️ 일조/사선은 배치·높이·이격·인접대지 조건에 따라 달라 수동 검토가 필요합니다."
      },
      "optional_inputs": ["height_m", "setback_m"],
      "auto_rules": [
        {
          "id": "daylight_missing",
          "priority": 100,
          "when_any": [
            { "op": "missing", "key": "height_m" },
            { "op": "missing", "key": "setback_m" }
          ],
          "result": "conditional",
          "message": "높이/이격 입력이 없어요. 입력하면 리스크(가능성) 안내를 더 정확히 할 수 있어요."
        }
      ]
    },

    {
      "id": "fire_escape",
      "rule_set": {
        "strategy": "first_match",
        "default_result": "conditional",
        "default_message": "⚠️ 피난/방화는 규모·층수·용도에 따라 강화됩니다. 기준표/해석이 필요해요."
      },
      "optional_inputs": ["floors", "gross_area_m2"],
      "auto_rules": [
        {
          "id": "fire_missing",
          "priority": 100,
          "when_any": [
            { "op": "missing", "key": "floors" },
            { "op": "missing", "key": "gross_area_m2" }
          ],
          "result": "conditional",
          "message": "층수/연면적 입력이 없어요. 입력하면 강화 가능성 판단이 더 정확해져요."
        },
        {
          "id": "conditional_high_risk",
          "priority": 80,
          "when_any": [
            { "op": "gte", "key": "floors", "value": 6 },
            { "op": "gte", "key": "gross_area_m2", "value": 2000 }
          ],
          "result": "conditional",
          "message": "⚠️ 규모/층수 기준으로 피난·방화 요구 강화 가능성 큼"
        },
        {
          "id": "allow_low_risk",
          "priority": 10,
          "when_all": [
            { "op": "present", "key": "floors" },
            { "op": "present", "key": "gross_area_m2" },
            { "op": "lt", "key": "floors", "value": 6 },
            { "op": "lt", "key": "gross_area_m2", "value": 2000 }
          ],
          "result": "allow",
          "message": "입력값 기준으로는 기본 범위 내(단, 용도/피난거리/방화구획 등 별도 검토 필요)"
        }
      ]
    },

    {
      "id": "elevator",
      "rule_set": {
        "strategy": "first_match",
        "default_result": "conditional",
        "default_message": "⚠️ 승강기 설치는 층수·용도·편의시설 기준과 함께 검토가 필요합니다."
      },
      "optional_inputs": ["floors"],
      "auto_rules": [
        {
          "id": "elevator_missing",
          "priority": 100,
          "when": { "op": "missing", "key": "floors" },
          "result": "conditional",
          "message": "층수 입력이 없어요. 층수를 입력하면 설치 가능성/리스크 안내가 더 정확해져요."
        },
        {
          "id": "conditional_elevator",
          "priority": 50,
          "when": { "op": "gte", "key": "floors", "value": 5 },
          "result": "conditional",
          "message": "층수 기준으로 승강기 설치(의무/권장) 가능성 큼 — 용도/규모 기준표 확인 필요"
        },
        {
          "id": "allow_low_floors",
          "priority": 10,
          "when": { "op": "lt", "key": "floors", "value": 5 },
          "result": "allow",
          "message": "층수 기준으로는 설치 의무 가능성이 낮음(단, 용도/편의시설/특수 기준은 별도)"
        }
      ]
    },

    {
      "id": "accessibility",
      "rule_set": {
        "strategy": "first_match",
        "default_result": "conditional",
        "default_message": "⚠️ 장애인 편의시설은 시설군(용도)·규모 기준으로 달라 수동 확인이 필요합니다."
      },
      "optional_inputs": ["gross_area_m2"],
      "auto_rules": [
        {
          "id": "accessibility_missing",
          "priority": 100,
          "when": { "op": "missing", "key": "gross_area_m2" },
          "result": "conditional",
          "message": "연면적 입력이 없어요. 연면적/시설군에 따라 적용 여부가 갈려요."
        },
        {
          "id": "conditional_accessibility",
          "priority": 10,
          "when": { "op": "gte", "key": "gross_area_m2", "value": 500 },
          "result": "conditional",
          "message": "규모 기준으로 편의시설 대상 가능성 — 최종은 시설군(용도) 기준표로 확인"
        }
      ]
    },

    {
      "id": "energy_plan",
      "rule_set": {
        "strategy": "first_match",
        "default_result": "conditional",
        "default_message": "⚠️ 에너지 관련 서류/기준은 용도·규모·적용 제도에 따라 달라요."
      },
      "optional_inputs": ["gross_area_m2"],
      "auto_rules": [
        {
          "id": "energy_missing",
          "priority": 100,
          "when": { "op": "missing", "key": "gross_area_m2" },
          "result": "conditional",
          "message": "연면적 입력이 없어요. 연면적을 입력하면 대상 가능성 안내가 더 정확해져요."
        },
        {
          "id": "conditional_energy",
          "priority": 10,
          "when": { "op": "gte", "key": "gross_area_m2", "value": 2000 },
          "result": "conditional",
          "message": "규모 기준으로 에너지 관련 서류/기준 대상 가능성"
        }
      ]
    },

    {
      "id": "structure_fireproof",
      "rule_set": {
        "strategy": "first_match",
        "default_result": "conditional",
        "default_message": "⚠️ 구조/내화 성능은 규모·층수·용도에 따라 요구가 강화됩니다. 구조/방재 기준표 확인 필요."
      },
      "optional_inputs": ["floors", "gross_area_m2"],
      "auto_rules": [
        {
          "id": "structure_missing",
          "priority": 100,
          "when_any": [
            { "op": "missing", "key": "floors" },
            { "op": "missing", "key": "gross_area_m2" }
          ],
          "result": "conditional",
          "message": "층수/연면적 입력이 없어요. 입력하면 강화 가능성 안내가 더 정확해져요."
        },
        {
          "id": "conditional_structure_fireproof",
          "priority": 10,
          "when_any": [
            { "op": "gte", "key": "floors", "value": 10 },
            { "op": "gte", "key": "gross_area_m2", "value": 8000 }
          ],
          "result": "conditional",
          "message": "규모/층수 기준으로 구조·내화 요구 강화 가능성"
        }
      ]
    },

    {
      "id": "district_plan",
      "rule_set": {
        "strategy": "first_match",
        "default_result": "conditional",
        "default_message": "⚠️ 지구단위계획/특별계획구역 적용 여부는 토지이용계획/고시문으로 확인이 필요합니다."
      },
      "optional_inputs": ["district_plan_known"],
      "auto_rules": [
        {
          "id": "district_plan_missing",
          "priority": 100,
          "when": { "op": "missing", "key": "district_plan_known" },
          "result": "conditional",
          "message": "지구단위계획 여부를 모르면(0) 토지이용계획확인서/지자체 시스템으로 확인해 주세요."
        },
        {
          "id": "district_plan_yes",
          "priority": 50,
          "when": { "op": "eq", "key": "district_plan_known", "value": 2 },
          "result": "conditional",
          "message": "지구단위계획 '해당' — 지구단위 기준이 법령보다 우선할 수 있어 세부 기준 확인 필요"
        },
        {
          "id": "district_plan_no",
          "priority": 10,
          "when": { "op": "eq", "key": "district_plan_known", "value": 1 },
          "result": "allow",
          "message": "지구단위계획 '해당없음' 입력 기준(단, 다른 지구/구역 지정 여부는 별도 확인)"
        }
      ]
    }
  ]
}
